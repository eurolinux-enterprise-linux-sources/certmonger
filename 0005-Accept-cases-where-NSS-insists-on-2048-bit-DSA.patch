From 582dab515e899d655057fd21e6bd0248764866e4 Mon Sep 17 00:00:00 2001
From: Nalin Dahyabhai <nalin@redhat.com>
Date: Wed, 2 Sep 2015 09:51:32 -0400
Subject: [PATCH] Accept cases where NSS insists on 2048-bit DSA

Also accept cases where NSS insists on 2048-bit keys when generating DSA
keys, where previously it insisted on 1024.
---
 tests/001-keyiread-dsa/expected.out.2048 | 4 ++++
 tests/Makefile.am                        | 1 +
 tests/Makefile.in                        | 1 +
 3 files changed, 6 insertions(+)
 create mode 100644 tests/001-keyiread-dsa/expected.out.2048

diff --git a/tests/001-keyiread-dsa/expected.out.2048 b/tests/001-keyiread-dsa/expected.out.2048
new file mode 100644
index 0000000000000000000000000000000000000000..5064317633edf60adf7a011ee37a15fe4ea1e0dc
--- /dev/null
+++ b/tests/001-keyiread-dsa/expected.out.2048
@@ -0,0 +1,4 @@
+OK (DSA:2048).
+OK (DSA:2048).
+OK (DSA:2048).
+Test complete.
diff --git a/tests/Makefile.am b/tests/Makefile.am
index ad9c436ae1c8fd29155f9571dbe5447f1f6a8956..750d99ea570969550aa80e76e1ea2456a48984e6 100644
--- a/tests/Makefile.am
+++ b/tests/Makefile.am
@@ -7,6 +7,7 @@ EXTRA_DIST = \
 	001-keyiread-rsa/expected.out \
 	001-keyiread-dsa/run.sh \
 	001-keyiread-dsa/expected.out \
+	001-keyiread-dsa/expected.out.2048 \
 	001-keyiread-ec/run.sh \
 	001-keyiread-ec/expected.out \
 	001-keyiread-ec/expected.out.2 \
diff --git a/tests/Makefile.in b/tests/Makefile.in
index b2f7b5ea05db5f7c9f499f9565a233eac11349f0..6a3f59906ce61edd22fce945ce73e5dadf69f087 100644
--- a/tests/Makefile.in
+++ b/tests/Makefile.in
@@ -414,6 +414,7 @@ EXTRA_DIST = \
 	001-keyiread-rsa/expected.out \
 	001-keyiread-dsa/run.sh \
 	001-keyiread-dsa/expected.out \
+	001-keyiread-dsa/expected.out.2048 \
 	001-keyiread-ec/run.sh \
 	001-keyiread-ec/expected.out \
 	001-keyiread-ec/expected.out.2 \
-- 
2.4.3

