[Generating key pair.]
NEED_KEY_PAIR
-START-
GENERATING_KEY_PAIR
HAVE_KEY_PAIR
NEED_KEYINFO
-STOP-

[Reading back key info.]
NEED_KEYINFO
-START-
READING_KEYINFO
HAVE_KEYINFO
NEED_CSR
-STOP-
key_size=2048

[Generating CSR.]
HAVE_KEYINFO
-START-
NEED_CSR
GENERATING_CSR
HAVE_CSR
-STOP-

[Getting CSR signed.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
NEED_TO_SAVE_CERT
-STOP-

[Saving certificate.]
NEED_TO_SAVE_CERT
-START-
START_SAVING_CERT
SAVING_CERT
NEED_TO_READ_CERT
READING_CERT
SAVED_CERT
NEED_TO_NOTIFY_ISSUED_SAVED
NOTIFYING_ISSUED_SAVED
Certificate in file "$tmpdir/certfile" issued by CA and saved.
MONITORING
-STOP-

[From-scratch enrollment scenario OK.]

[Picking up mid-life without a key or a certificate.]
NEWLY_ADDED
-START-
NEWLY_ADDED_START_READING_KEYINFO
NEWLY_ADDED_READING_KEYINFO
NEWLY_ADDED_START_READING_CERT
NEWLY_ADDED_READING_CERT
NEWLY_ADDED_DECIDING
NEED_KEY_PAIR
-STOP-

[Picking up mid-life without a certificate.]
NEWLY_ADDED
-START-
NEWLY_ADDED_START_READING_KEYINFO
NEWLY_ADDED_READING_KEYINFO
NEWLY_ADDED_START_READING_CERT
NEWLY_ADDED_READING_CERT
NEWLY_ADDED_DECIDING
NEED_CSR
-STOP-

[Picking up mid-life.]
NEWLY_ADDED
-START-
NEWLY_ADDED_START_READING_KEYINFO
NEWLY_ADDED_READING_KEYINFO
NEWLY_ADDED_START_READING_CERT
NEWLY_ADDED_READING_CERT
NEWLY_ADDED_DECIDING
MONITORING
-STOP-

[Retroactive issuing.]
HAVE_KEY_PAIR
-START-
NEED_KEYINFO
READING_KEYINFO
HAVE_KEYINFO
NEED_CSR
-STOP-
HAVE_KEYINFO
-START-
NEED_CSR
GENERATING_CSR
HAVE_CSR
-STOP-
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
NEED_TO_SAVE_CERT
-STOP-
NEED_TO_SAVE_CERT
-START-
START_SAVING_CERT
SAVING_CERT
NEED_TO_READ_CERT
READING_CERT
SAVED_CERT
NEED_TO_NOTIFY_ISSUED_SAVED
NOTIFYING_ISSUED_SAVED
Certificate in file "$tmpdir/certfile2" issued by CA and saved.
MONITORING
-STOP-
notBefore=Jan  1 00:00:00 1970 GMT
notAfter=Jan  2 00:00:00 1970 GMT

[Noticing expiration.]
notBefore=Jan  1 00:00:00 1970 GMT
notAfter=Jan  2 00:00:00 1970 GMT
MONITORING
-START-
NEED_TO_NOTIFY_VALIDITY
NOTIFYING_VALIDITY
Certificate in file "$tmpdir/certfile2" is no longer valid.
delay=86400
MONITORING
-STOP-

[Kicking off autorenew.]
notBefore=Jan  1 00:00:00 1970 GMT
notAfter=Jan  2 00:00:00 1970 GMT
MONITORING
-START-
NEED_TO_NOTIFY_VALIDITY
NOTIFYING_VALIDITY
Certificate in file "$tmpdir/certfile2" is no longer valid.
NEED_CSR
-STOP-

[Enroll until we notice we have no specified CA.]
HAVE_KEY_PAIR
-START-
NEED_KEYINFO
READING_KEYINFO
HAVE_KEYINFO
NEED_CSR
-STOP-
HAVE_KEYINFO
-START-
NEED_CSR
GENERATING_CSR
HAVE_CSR
-STOP-
HAVE_CSR
-START-
NEED_TO_SUBMIT
NEED_CA
-STOP-

[Enroll until the CA tells us to come back later.]
HAVE_KEY_PAIR
-START-
NEED_KEYINFO
READING_KEYINFO
HAVE_KEYINFO
NEED_CSR
-STOP-
HAVE_KEYINFO
-START-
NEED_CSR
GENERATING_CSR
HAVE_CSR
-STOP-
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=604800
CA_WORKING
-STOP-
ca_cookie=iLoveCookiesSome
HAVE_CSR
-START-
NEED_TO_SUBMIT
-STOP-

[Enroll until the CA rejects us.]
HAVE_KEY_PAIR
-START-
NEED_KEYINFO
READING_KEYINFO
HAVE_KEYINFO
NEED_CSR
-STOP-
HAVE_KEYINFO
-START-
NEED_CSR
GENERATING_CSR
HAVE_CSR
-STOP-
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
NEED_TO_NOTIFY_REJECTION
-STOP-
NEED_TO_NOTIFY_REJECTION
-START-
NOTIFYING_REJECTION
Request for certificate to be stored in file "$tmpdir/certfile3" rejected by CA.
CA_REJECTED
-STOP-
CA_REJECTED
-START-
CA_REJECTED
-STOP-

[Enroll until the CA turns out to be unreachable.]
HAVE_KEY_PAIR
-START-
NEED_KEYINFO
READING_KEYINFO
HAVE_KEYINFO
NEED_CSR
-STOP-
HAVE_KEYINFO
-START-
NEED_CSR
GENERATING_CSR
HAVE_CSR
-STOP-
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=604800
CA_UNREACHABLE
-STOP-
HAVE_CSR
-START-
NEED_TO_SUBMIT
-STOP-

[Enroll until the CA client turns out to be unconfigured.]
HAVE_KEY_PAIR
-START-
NEED_KEYINFO
READING_KEYINFO
HAVE_KEYINFO
NEED_CSR
-STOP-
HAVE_KEYINFO
-START-
NEED_CSR
GENERATING_CSR
HAVE_CSR
-STOP-
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=604800
CA_UNCONFIGURED
-STOP-
HAVE_CSR
-START-
NEED_TO_SUBMIT
-STOP-

[Enroll until the CA tells us to come back later.]
HAVE_KEY_PAIR
-START-
NEED_KEYINFO
READING_KEYINFO
HAVE_KEYINFO
NEED_CSR
-STOP-
HAVE_KEYINFO
-START-
NEED_CSR
GENERATING_CSR
HAVE_CSR
-STOP-
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=13
CA_WORKING
-STOP-
ca_cookie=iLoveCookiesMore
HAVE_CSR
-START-
NEED_TO_SUBMIT
-STOP-

[Enroll until we realize our enrollment helper doesn't support enrollment.]
HAVE_KEY_PAIR
-START-
NEED_KEYINFO
READING_KEYINFO
HAVE_KEYINFO
NEED_CSR
-STOP-
HAVE_KEYINFO
-START-
NEED_CSR
GENERATING_CSR
HAVE_CSR
-STOP-
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
NEED_GUIDANCE
-STOP-

[CA poll timeout remaining=0.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=300
CA_UNREACHABLE
-STOP-

[CA poll timeout remaining=0.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=300
CA_WORKING
-STOP-

[CA poll timeout remaining=0.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=300
CA_UNCONFIGURED
-STOP-

[Monitor poll timeout remaining=0.]
MONITORING
-START-
delay=1800
MONITORING
-STOP-

[CA poll timeout remaining=30.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=300
CA_UNREACHABLE
-STOP-

[CA poll timeout remaining=30.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=300
CA_WORKING
-STOP-

[CA poll timeout remaining=30.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=300
CA_UNCONFIGURED
-STOP-

[Monitor poll timeout remaining=30.]
MONITORING
-START-
delay=1800
MONITORING
-STOP-

[CA poll timeout remaining=1800.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=900
CA_UNREACHABLE
-STOP-

[CA poll timeout remaining=1800.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=900
CA_WORKING
-STOP-

[CA poll timeout remaining=1800.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=900
CA_UNCONFIGURED
-STOP-

[Monitor poll timeout remaining=1800.]
MONITORING
-START-
delay=1800
MONITORING
-STOP-

[CA poll timeout remaining=3600.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=1800
CA_UNREACHABLE
-STOP-

[CA poll timeout remaining=3600.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=1800
CA_WORKING
-STOP-

[CA poll timeout remaining=3600.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=1800
CA_UNCONFIGURED
-STOP-

[Monitor poll timeout remaining=3600.]
MONITORING
-START-
delay=1800
MONITORING
-STOP-

[CA poll timeout remaining=7200.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=3600
CA_UNREACHABLE
-STOP-

[CA poll timeout remaining=7200.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=3600
CA_WORKING
-STOP-

[CA poll timeout remaining=7200.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=3600
CA_UNCONFIGURED
-STOP-

[Monitor poll timeout remaining=7200.]
MONITORING
-START-
delay=3600
MONITORING
-STOP-

[CA poll timeout remaining=86000.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=43000
CA_UNREACHABLE
-STOP-

[CA poll timeout remaining=86000.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=43000
CA_WORKING
-STOP-

[CA poll timeout remaining=86000.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=43000
CA_UNCONFIGURED
-STOP-

[Monitor poll timeout remaining=86000.]
MONITORING
-START-
delay=43000
MONITORING
-STOP-

[CA poll timeout remaining=86500.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=43250
CA_UNREACHABLE
-STOP-

[CA poll timeout remaining=86500.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=43250
CA_WORKING
-STOP-

[CA poll timeout remaining=86500.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=43250
CA_UNCONFIGURED
-STOP-

[Monitor poll timeout remaining=86500.]
MONITORING
-START-
delay=43250
MONITORING
-STOP-

[CA poll timeout remaining=604800.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=302400
CA_UNREACHABLE
-STOP-

[CA poll timeout remaining=604800.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=302400
CA_WORKING
-STOP-

[CA poll timeout remaining=604800.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=302400
CA_UNCONFIGURED
-STOP-

[Monitor poll timeout remaining=604800.]
MONITORING
-START-
delay=86400
MONITORING
-STOP-

[CA poll timeout remaining=1000000.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=500000
CA_UNREACHABLE
-STOP-

[CA poll timeout remaining=1000000.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=500000
CA_WORKING
-STOP-

[CA poll timeout remaining=1000000.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=500000
CA_UNCONFIGURED
-STOP-

[Monitor poll timeout remaining=1000000.]
MONITORING
-START-
delay=86400
MONITORING
-STOP-

[CA poll timeout remaining=2000000.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=604800
CA_UNREACHABLE
-STOP-

[CA poll timeout remaining=2000000.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=604800
CA_WORKING
-STOP-

[CA poll timeout remaining=2000000.]
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
delay=604800
CA_UNCONFIGURED
-STOP-

[Monitor poll timeout remaining=2000000.]
MONITORING
-START-
delay=86400
MONITORING
-STOP-

[Kicking off split monitor/enroll TTL tests.]
NEWLY_ADDED
-START-
NEWLY_ADDED_START_READING_KEYINFO
NEWLY_ADDED_READING_KEYINFO
NEWLY_ADDED_START_READING_CERT
NEWLY_ADDED_READING_CERT
NEWLY_ADDED_DECIDING
NEED_KEY_PAIR
-STOP-
NEED_KEY_PAIR
-START-
GENERATING_KEY_PAIR
HAVE_KEY_PAIR
NEED_KEYINFO
READING_KEYINFO
HAVE_KEYINFO
NEED_CSR
-STOP-
HAVE_KEYINFO
-START-
NEED_CSR
GENERATING_CSR
HAVE_CSR
-STOP-
HAVE_CSR
-START-
NEED_TO_SUBMIT
SUBMITTING
NEED_TO_SAVE_CERT
-STOP-
NEED_TO_SAVE_CERT
-START-
START_SAVING_CERT
SAVING_CERT
NEED_TO_READ_CERT
READING_CERT
SAVED_CERT
NEED_TO_NOTIFY_ISSUED_SAVED
NOTIFYING_ISSUED_SAVED
MONITORING
-STOP-

[Kicking off enroll only.]
notBefore=Jan  1 00:00:00 1970 GMT
notAfter=Jan  1 00:00:00 1971 GMT
MONITORING
-START-
NEED_CSR
GENERATING_CSR
HAVE_CSR
NEED_TO_SUBMIT
SUBMITTING
NEED_TO_SAVE_CERT
START_SAVING_CERT
SAVING_CERT
NEED_TO_READ_CERT
READING_CERT
SAVED_CERT
NEED_TO_NOTIFY_ISSUED_SAVED
NOTIFYING_ISSUED_SAVED
MONITORING
-STOP-

[Kicking off notify only.]
notBefore=Jan  1 00:00:00 1970 GMT
notAfter=Jan  1 00:00:00 1971 GMT
MONITORING
-START-
NEED_TO_NOTIFY_VALIDITY
NOTIFYING_VALIDITY
delay=86400
MONITORING
-STOP-

[Kicking off notify-then-submit.]
notBefore=Jan  1 00:00:00 1970 GMT
notAfter=Jan  1 00:00:00 1971 GMT
MONITORING
-START-
NEED_TO_NOTIFY_VALIDITY
NOTIFYING_VALIDITY
NEED_CSR
GENERATING_CSR
HAVE_CSR
NEED_TO_SUBMIT
SUBMITTING
NEED_TO_SAVE_CERT
START_SAVING_CERT
SAVING_CERT
NEED_TO_READ_CERT
READING_CERT
SAVED_CERT
NEED_TO_NOTIFY_ISSUED_SAVED
NOTIFYING_ISSUED_SAVED
MONITORING
-STOP-
The sky is falling: Certificate in file "$tmpdir/certfile10" is no longer valid.
The sky is falling: Certificate in file "$tmpdir/certfile10" issued by CA and saved.

Test complete.
